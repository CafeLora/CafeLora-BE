(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02a875ed"],{"0b3f":function(e,t,n){},"25f0":function(e,t,n){"use strict";var i=n("e330"),r=n("5e77").PROPER,a=n("6eeb"),o=n("825a"),c=n("3a9b"),u=n("577e"),s=n("d039"),l=n("ad6d"),d="toString",m=RegExp.prototype,b=m[d],p=i(l),f=s((function(){return"/a/b"!=b.call({source:"a",flags:"b"})})),v=r&&b.name!=d;(f||v)&&a(RegExp.prototype,d,(function(){var e=o(this),t=u(e.source),n=e.flags,i=u(void 0===n&&c(m,e)&&!("flags"in m)?p(e):n);return"/"+t+"/"+i}),{unsafe:!0})},"2dd4":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("ac1f"),n("5319"),n("d3b7"),n("25f0");function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)}))}},"408a":function(e,t,n){var i=n("e330");e.exports=i(1..valueOf)},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var i=n("e330"),r=n("1d80"),a=n("577e"),o=n("5899"),c=i("".replace),u="["+o+"]",s=RegExp("^"+u+u+"*"),l=RegExp(u+u+"*$"),d=function(e){return function(t){var n=a(r(t));return 1&e&&(n=c(n,s,"")),2&e&&(n=c(n,l,"")),n}};e.exports={start:d(1),end:d(2),trim:d(3)}},"71ad":function(e,t,n){"use strict";n.r(t);var i=n("7a23"),r=function(e){return Object(i["J"])("data-v-3b3eb82a"),e=e(),Object(i["H"])(),e},a={id:"main"},o=r((function(){return Object(i["m"])("i",{class:"fas fa-chevron-circle-left"},null,-1)})),c=Object(i["o"])(" Volver "),u=[o,c],s=r((function(){return Object(i["m"])("br",null,null,-1)})),l={key:0,style:{display:"flex","align-items":"center","justify-content":"space-between"}},d=r((function(){return Object(i["m"])("h4",{style:{display:"inline"}}," Ingrese el porcentaje de cumplimiento deseado: ",-1)})),m=["min","value"],b=["title"],p=r((function(){return Object(i["m"])("i",{class:"fas fa-info-circle"},null,-1)})),f=[p],v=r((function(){return Object(i["m"])("br",null,null,-1)})),g=r((function(){return Object(i["m"])("h4",{style:{display:"inline"}}," Ingrese el margen de error que usted desee: ",-1)})),j=["value"],h=r((function(){return Object(i["m"])("abbr",{title:"Puede el poner el margen que desee pero se le recomienda un máximo de 10 "},[Object(i["m"])("i",{class:"fas fa-info-circle"})],-1)})),O={class:"grid"},x=r((function(){return Object(i["m"])("thead",{class:"header-grid"},[Object(i["m"])("tr",null,[Object(i["m"])("th",null,"Nivel de riesgo"),Object(i["m"])("th",null,"Porcentaje de cumplimiento actual")])],-1)})),I={class:"options-buttons",style:{display:"flex","align-items":"center"}},y=["disabled"],R={class:"summary"},w={class:"header-summary"},k={class:"summary-body"},C={class:"body-item-header flex-row",style:{paddingbottom:"20px",paddingtop:"20px"}},q={style:{width:"70%"}},E={style:{marginleft:"5px"}},N={class:"body-item-content",style:{paddingbottom:"20px"}},S={class:"flex-row",style:{"justify-content":"flex-start",gap:"20px"}},T=r((function(){return Object(i["m"])("p",null,"Justificación:",-1)})),M=["value"],_=r((function(){return Object(i["m"])("i",{class:"far fa-file-pdf"},null,-1)})),A=["onClick"],D=r((function(){return Object(i["m"])("br",null,null,-1)})),G={key:0,class:"flex-row",style:{"justify-content":"flex-start",gap:"20px"}},V=r((function(){return Object(i["m"])("p",null,"Recomendación:",-1)})),J=["onUpdate:modelValue"],P=["onClick","disabled"],U=r((function(){return Object(i["m"])("br",null,null,-1)}));function B(e,t,n,r,o,c){var p,B,L=Object(i["O"])("nav-bar"),Q=Object(i["O"])("modal");return Object(i["G"])(),Object(i["l"])(i["b"],null,[Object(i["p"])(L,{name:null===(p=e.userInfoJson)||void 0===p?void 0:p.nombres,lastName:null===(B=e.userInfoJson)||void 0===B?void 0:B.apellidos},null,8,["name","lastName"]),Object(i["p"])(Q,{show:!!e.message,title:e.message,onClose:e.handleError,error:e.error,loading:e.loading},null,8,["show","title","onClose","error","loading"]),Object(i["m"])("section",a,[Object(i["m"])("h1",{style:{"text-align":"left",cursor:"pointer"},onClick:t[0]||(t[0]=function(){return e.back&&e.back.apply(e,arguments)})},u),s,e.canEdit?(Object(i["G"])(),Object(i["l"])("div",l,[Object(i["m"])("div",null,[Object(i["m"])("div",null,[d,Object(i["m"])("input",{class:"percentage",type:"number",min:e.porcentajeCumplimiento,onChange:t[1]||(t[1]=function(){return e.setValue&&e.setValue.apply(e,arguments)}),value:e.porcentajeCumplimientoDeseado},null,40,m),Object(i["m"])("abbr",{title:"El valor debe ser mayor o igual a "+e.porcentajeCumplimiento},f,8,b)]),v,Object(i["m"])("div",null,[g,Object(i["m"])("input",{class:"percentage",type:"number",min:"0",onChange:t[2]||(t[2]=function(){return e.setValue2&&e.setValue2.apply(e,arguments)}),value:e.margen},null,40,j),h])]),Object(i["m"])("div",null,[Object(i["m"])("table",O,[x,Object(i["m"])("tbody",{class:Object(i["x"])(e.rowBodyStyle?e.rowBodyStyle:"")},[Object(i["m"])("tr",null,[Object(i["m"])("td",null,Object(i["Q"])(e.nivelDeRiesgo),1),Object(i["m"])("td",null,Object(i["Q"])(e.porcentajeCumplimiento)+" %",1)])],2)])]),Object(i["m"])("div",I,[Object(i["m"])("button",{class:"action-button",onClick:t[3]||(t[3]=function(){return e.summary&&e.summary.apply(e,arguments)})},"Resumen"),Object(i["m"])("button",{class:Object(i["x"])(["action-button",e.porcentajeCumplimientoDeseado<e.porcentajeCumplimiento?"action-button blocked":"action-button"]),onClick:t[4]||(t[4]=function(){return e.idealScenario&&e.idealScenario.apply(e,arguments)}),disabled:e.porcentajeCumplimientoDeseado<e.porcentajeCumplimiento}," Escenario deseado ",10,y)])])):Object(i["k"])("",!0),Object(i["m"])("div",R,[Object(i["m"])("div",w,[Object(i["m"])("h1",null,Object(i["Q"])(e.headingTitle),1)]),Object(i["m"])("div",k,[(Object(i["G"])(!0),Object(i["l"])(i["b"],null,Object(i["M"])(e.requerimientos,(function(t,n){var r,a,o,c,u,s,l;return Object(i["G"])(),Object(i["l"])("div",{class:"body-item",key:t.requerimientoId},[Object(i["m"])("div",C,[Object(i["m"])("h3",null,"Pregunta "+Object(i["Q"])(t.posicion?t.posicion:n+1)+":",1),Object(i["m"])("span",q,Object(i["Q"])(t.descripcion),1),Object(i["m"])("span",E,Object(i["Q"])(e.respuestaItem(n)),1)]),Object(i["m"])("div",N,[Object(i["m"])("div",S,[T,Object(i["m"])("textarea",{name:"justificacion",id:"justi",cols:"80",rows:"5",style:{width:"85%"},disabled:"true",value:null===(r=e.evidenciaRequerimiento[n])||void 0===r?void 0:r.justificacion},null,8,M),Object(i["m"])("div",null,[_,Object(i["m"])("span",{style:{textdecoration:"underline",cursor:"pointer"},onClick:function(t){return e.downloadEvidencia(e.evidencia[n])}},"Descargar evidencia",8,A)])]),D,e.evidenciaRequerimiento[n]?(Object(i["G"])(),Object(i["l"])("div",G,[V,Object(i["ab"])(Object(i["m"])("textarea",{name:"recomendacion",id:"recom",cols:"120",rows:"5",style:{width:"85%"},disabled:"true","onUpdate:modelValue":function(t){return e.evidenciaRequerimiento[n].recomendacion=t}},null,8,J),[[i["V"],e.evidenciaRequerimiento[n].recomendacion]]),null!=(null===(a=e.evidenciaRequerimiento[n])||void 0===a?void 0:a.respuestaItem)&&1!=(null===(o=e.evidenciaRequerimiento[n])||void 0===o?void 0:o.respuestaItem)&&e.canEdit?(Object(i["G"])(),Object(i["l"])("button",{key:0,class:Object(i["x"])(null==(null===(c=e.evidenciaRequerimiento[n])||void 0===c?void 0:c.respuestaItem)||1==(null===(u=e.evidenciaRequerimiento[n])||void 0===u?void 0:u.respuestaItem)||null!==(s=e.evidenciaRequerimiento[n])&&void 0!==s&&s.accionMigitagcion?"action-button thin blocked":"action-button thin"),onClick:function(t){return e.saveRecomendacion(n)},disabled:null===(l=e.evidenciaRequerimiento[n])||void 0===l?void 0:l.accionMigitagcion}," Añadir ("+Object(i["Q"])(e.accionesMitigacionCreadas)+") ",11,P)):Object(i["k"])("",!0)])):Object(i["k"])("",!0),U])])})),128))])])])],64)}var L=n("b85c"),Q=n("1da1"),$=(n("96cf"),n("d3b7"),n("99af"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("a9e3"),n("25f0"),n("4de4"),n("d81d"),n("7db0"),n("159b"),n("4e82"),n("4ec9"),n("e9c4"),n("5c40")),F=n("f464"),H=n("d43e"),z=n("f50d"),X=n("b74e"),Y=n("2dd4"),K=n("705f"),W=n("2fc2"),Z=Object($["s"])({components:{NavBar:F["a"],Modal:K["a"]},data:function(){return{userInfoJson:Object(H["p"])(),headingTitle:"Resumen",evidencia:[],evidenciaRequerimiento:[],requerimientos:[],criterios:[],porcentajeCumplimiento:0,porcentajeCumplimientoDeseado:0,margen:0,nivelDeRiesgo:"",accionesMitigacionCreadas:0,message:null,loading:!1,pruebaResultados:{},error:!1,canEdit:!1}},methods:{downloadEvidencia:function(e){var t=this;return Object(Q["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.message="Cargando...";try{fetch("".concat(W["b"],"evidencia/downloadfile/").concat(e.adjuntoURL),{method:"GET",headers:new Headers({Authorization:"Bearer "+localStorage.getItem("token")})}).then((function(e){return e.blob()})).then((function(n){var i=window.URL.createObjectURL(n),r=document.createElement("a");r.href=i,r.download=e.adjunto,document.body.appendChild(r),r.click(),r.remove(),t.message=null}))}catch(i){console.log(i)}case 2:case"end":return n.stop()}}),n)})))()},handleError:function(){this.message=null},setValue:function(e){Number(e.target.value)<this.porcentajeCumplimiento&&(e.target.value=this.porcentajeCumplimiento.toString()),this.porcentajeCumplimientoDeseado=+e.target.value},setValue2:function(e){this.margen=+e.target.value},back:function(){this.$router.back()},summary:function(){var e=this;return Object(Q["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.realScenario();case 2:case"end":return t.stop()}}),t)})))()},idealScenario:function(){var e=this;return Object(Q["a"])(regeneratorRuntime.mark((function t(){var n,i,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.porcentajeCumplimientoDeseado<e.porcentajeCumplimiento&&e.margen>=0)){t.next=2;break}return t.abrupt("return");case 2:return e.message="Cargando...",t.prev=3,t.next=6,fetch("".concat(W["b"],"prueba/").concat(e.$route.params.pr_codigo,"/").concat(e.porcentajeCumplimientoDeseado,"/").concat(e.margen),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 6:return n=t.sent,t.next=9,Object(X["a"])(n);case 9:return t.next=11,n.json();case 11:i=t.sent,e.requerimientos=e.requerimientos.filter((function(e,t){return i.some((function(n){if(n.requerimientoId==e.requerimientoId)return e.posicion=t+1,!0}))})),i.length>0&&(e.evidencia=[],e.evidenciaRequerimiento=[],i=e.requerimientos.map((function(e){return i.find((function(t){return t.requerimientoId==e.requerimientoId}))})).filter((function(e){return void 0!==e})),i.forEach((function(t){var n,i,r,a,o;e.evidencia.push({evidenciaId:null===(n=t.evidencia)||void 0===n?void 0:n.evidenciaId,nombre:null===(i=t.evidencia)||void 0===i?void 0:i.nombre,adjunto:null===(r=t.evidencia)||void 0===r?void 0:r.adjunto,codigo:null===(a=t.evidencia)||void 0===a?void 0:a.codigo,adjuntoURL:null===(o=t.evidencia)||void 0===o?void 0:o.adjuntoURL}),e.evidenciaRequerimiento.push({evidenciaId:t.evidenciaId,requerimientoId:t.requerimientoId,pruebaId:t.pruebaId,justificacion:t.justificacion,respuestaItem:t.respuestaItem,recomendacion:t.recomendacion,tratamientoId:t.tratamientoId,tratamientoCodigo:t.tratamientoCodigo,accionMigitagcion:t.accionMigitagcion})}))),e.headingTitle="Escenario deseado",e.message="",t.next=24;break;case 18:t.prev=18,t.t0=t["catch"](3),e.error=!0,r=JSON.parse(t.t0.message),a=r.errores.mensaje,e.message=a;case 24:case"end":return t.stop()}}),t,null,[[3,18]])})))()},realScenario:function(){var e=this;return Object(Q["a"])(regeneratorRuntime.mark((function t(){var n,i,r,a,o,c,u,s,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=1,e.message="Cargando...",t.prev=2,t.next=5,fetch("".concat(W["b"],"listaverificaciones/lista?filter=").concat(e.$route.params.lv_codigo,"&nuevo=").concat(n),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 5:return i=t.sent,t.next=8,i.json();case 8:r=t.sent,a=r[0].requerimientos.map((function(e){return e.criterio})).sort((function(e,t){return e.descripcion.localeCompare(t.descripcion)})),o=new Map,c=Object(L["a"])(a);try{for(c.s();!(u=c.n()).done;)s=u.value,o.has(s.descripcion)||(o.set(s.descripcion,!0),e.criterios.push(s))}catch(m){c.e(m)}finally{c.f()}e.requerimientos=r[0].requerimientos.sort((function(e,t){return e.criterio.descripcion.localeCompare(t.criterio.descripcion)})),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](2),console.log(t.t0);case 19:return t.prev=19,t.next=22,fetch("".concat(W["b"],"evidenciarequerimiento/").concat(e.$route.params.pr_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 22:return l=t.sent,t.next=25,l.json();case 25:d=t.sent,console.log(d),e.porcentajeCumplimiento=d[0].pruebaPorcentajeCumplimiento,e.accionesMitigacionCreadas=d.filter((function(e){return e.accionMigitagcion})).length,d.length>0&&(e.evidencia=[],e.evidenciaRequerimiento=[],d=e.requerimientos.map((function(e){return d.find((function(t){return t.requerimientoId==e.requerimientoId}))})).filter((function(e){return void 0!==e})),d.forEach((function(t){var n,i,r,a,o;e.evidencia.push({evidenciaId:null===(n=t.evidencia)||void 0===n?void 0:n.evidenciaId,nombre:null===(i=t.evidencia)||void 0===i?void 0:i.nombre,adjunto:null===(r=t.evidencia)||void 0===r?void 0:r.adjunto,codigo:null===(a=t.evidencia)||void 0===a?void 0:a.codigo,adjuntoURL:null===(o=t.evidencia)||void 0===o?void 0:o.adjuntoURL}),e.evidenciaRequerimiento.push({evidenciaId:t.evidenciaId,requerimientoId:t.requerimientoId,pruebaId:t.pruebaId,justificacion:t.justificacion,respuestaItem:t.respuestaItem,recomendacion:t.recomendacion,tratamientoId:t.tratamientoId,tratamientoCodigo:t.tratamientoCodigo,accionMigitagcion:t.accionMigitagcion})}))),e.headingTitle="Resumen",e.message="",t.next=37;break;case 34:t.prev=34,t.t1=t["catch"](19),console.log(t.t1);case 37:case"end":return t.stop()}}),t,null,[[2,16],[19,34]])})))()},obtenerPruebaResults:function(){var e=this;return Object(Q["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(W["b"],"prueba/").concat(e.$route.params.pr_codigo),{method:"GET",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")})});case 3:return n=t.sent,t.next=6,Object(X["a"])(n);case 6:return t.next=8,n.json();case 8:e.pruebaResultados=t.sent,e.nivelDeRiesgo=e.pruebaResultados.nivelDeRiesgo,t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](0),e.error=!0,JSON.parse(t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()},respuestaItem:function(e){var t,n="No implementado";switch(null===(t=this.evidenciaRequerimiento[e])||void 0===t?void 0:t.respuestaItem){case 1:n="Totalmente";break;case.5:n="Parcialmente";break;case 0:n="No implementado";break;case null:n="No aplica";break;default:break}return n},saveRecomendacion:function(e){var t=this;return Object(Q["a"])(regeneratorRuntime.mark((function n(){var i,r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.evidenciaRequerimiento[e],r={TratamientoId:i.tratamientoId,AccionMitigacionId:Object(Y["a"])(),Descripcion:t.requerimientos[e].descripcion,Estado:!1},n.prev=2,n.next=5,fetch("".concat(W["b"],"evidenciarequerimiento/").concat(i.pruebaId,"/").concat(i.requerimientoId),{method:"PUT",headers:new Headers({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}),body:JSON.stringify(r)});case 5:return a=n.sent,n.next=8,Object(X["a"])(a);case 8:t.evidenciaRequerimiento[e].accionMigitagcion=!0,t.accionesMitigacionCreadas++,n.next=15;break;case 12:n.prev=12,n.t0=n["catch"](2),console.log(n.t0);case 15:case"end":return n.stop()}}),n,null,[[2,12]])})))()}},mounted:function(){var e=this;Object(Q["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(z["a"])();case 2:return e.userInfoJson=t.sent,e.userInfoJson.rol==W["q"].JEFE_DE_RIESGOS&&"true"==e.$route.query.edit?e.canEdit=!0:e.canEdit=!1,t.next=6,e.realScenario();case 6:return t.next=8,e.obtenerPruebaResults();case 8:case"end":return t.stop()}}),t)})))()}}),ee=(n("e83d"),n("6b0d")),te=n.n(ee);const ne=te()(Z,[["render",B],["__scopeId","data-v-3b3eb82a"]]);t["default"]=ne},"7db0":function(e,t,n){"use strict";var i=n("23e7"),r=n("b727").find,a=n("44d2"),o="find",c=!0;o in[]&&Array(1)[o]((function(){c=!1})),i({target:"Array",proto:!0,forced:c},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),a(o)},a79f:function(e,t,n){"use strict";n("db0d")},a9e3:function(e,t,n){"use strict";var i=n("83ab"),r=n("da84"),a=n("e330"),o=n("94ca"),c=n("6eeb"),u=n("1a2d"),s=n("7156"),l=n("3a9b"),d=n("d9b5"),m=n("c04e"),b=n("d039"),p=n("241c").f,f=n("06cf").f,v=n("9bf2").f,g=n("408a"),j=n("58a8").trim,h="Number",O=r[h],x=O.prototype,I=r.TypeError,y=a("".slice),R=a("".charCodeAt),w=function(e){var t=m(e,"number");return"bigint"==typeof t?t:k(t)},k=function(e){var t,n,i,r,a,o,c,u,s=m(e,"number");if(d(s))throw I("Cannot convert a Symbol value to a number");if("string"==typeof s&&s.length>2)if(s=j(s),t=R(s,0),43===t||45===t){if(n=R(s,2),88===n||120===n)return NaN}else if(48===t){switch(R(s,1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+s}for(a=y(s,2),o=a.length,c=0;c<o;c++)if(u=R(a,c),u<48||u>r)return NaN;return parseInt(a,i)}return+s};if(o(h,!O(" 0o1")||!O("0b1")||O("+0x1"))){for(var C,q=function(e){var t=arguments.length<1?0:O(w(e)),n=this;return l(x,n)&&b((function(){g(n)}))?s(Object(t),n,q):t},E=i?p(O):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),N=0;E.length>N;N++)u(O,C=E[N])&&!u(q,C)&&v(q,C,f(O,C));q.prototype=x,x.constructor=q,c(r,h,q)}},db0d:function(e,t,n){},e83d:function(e,t,n){"use strict";n("0b3f")},f464:function(e,t,n){"use strict";n("b0c0");var i=n("7a23"),r=n("14ed"),a=n.n(r),o={class:"header"};function c(e,t,n,r,c,u){return Object(i["G"])(),Object(i["l"])("div",o,[Object(i["m"])("img",{id:"logo",onClick:t[0]||(t[0]=function(t){return e.goToDashboard()}),alt:"logo_banner",src:a.a,width:"120",height:"50"}),Object(i["m"])("p",null,"Bienvenido: "+Object(i["Q"])(e.name+" "+e.lastName),1)])}var u=n("5c40"),s=Object(u["s"])({props:["name","lastName"],methods:{goToDashboard:function(){this.$router.push("/dashboard")}}}),l=(n("a79f"),n("6b0d")),d=n.n(l);const m=d()(s,[["render",c],["__scopeId","data-v-765609f5"]]);t["a"]=m}}]);
//# sourceMappingURL=chunk-02a875ed.df8ede3c.js.map